<?php
include 'connect.php';

if(isset($_COOKIE['user_id'])){
   $user_id = $_COOKIE['user_id'];
}else{
   $user_id = '';
}

if(isset($_POST['add_product'])){
  $id=create_unique_id();
  $product_name = $_POST['product_name'];
  $product_name = filter_var($_POST['product_name'], FILTER_SANITIZE_STRING);
  $product_price = $_POST['product_price'];
  $product_price = filter_var($_POST['product_price'], FILTER_SANITIZE_STRING);
  $color = $_POST['color'];
  $color = filter_var($_POST['color'], FILTER_SANITIZE_STRING);
  $size = $_POST['size'];
  $size = filter_var($_POST['size'], FILTER_SANITIZE_STRING);
  $product_brand = $_POST['product_brand'];
  $product_brand = filter_var($_POST['product_brand'], FILTER_SANITIZE_STRING);
  $product_material = $_POST['product_material'];
  $product_material = filter_var($_POST['product_material'], FILTER_SANITIZE_STRING);
  $product_manufacturer = $_POST['product_manufacturer'];
  $product_manufacturer = filter_var($_POST['product_manufacturer'], FILTER_SANITIZE_STRING);

  if(isset($_POST['available'])){
    $available = $_POST['available'];
    $available = filter_var($available, FILTER_SANITIZE_STRING);
  }else{
    $available = 'no';
  }
  if(isset($_POST['rated'])){
    $rated = $_POST['rated'];
    $rated = filter_var($rated, FILTER_SANITIZE_STRING);
  }else{
    $rated = 'no';
  }
  if(isset($_POST['installation'])){
    $installation = $_POST['installation'];
    $installation = filter_var($installation, FILTER_SANITIZE_STRING);
  }else{
    $installation = 'no';
  }
  if(isset($_POST['warranty'])){
    $warranty = $_POST['warranty'];
    $warranty = filter_var($warranty, FILTER_SANITIZE_STRING);
  }else{
    $warranty = 'no';
  }

  $image_01 = $_FILES['image_01']['name'];
  $image_01 = filter_var($image_01, FILTER_SANITIZE_STRING);
  $image_01_ext=pathinfo($image_01, PATHINFO_EXTENSION);
  $rename_image_01 = create_unique_id().'.'.$image_01_ext;
  $image_01_tmp_name = $_FILES['image_01']['tmp_name'];
  $image_01_size = $_FILES['image_01']['size'];
  $image_01_folder = 'uploaded_files/'.$rename_image_01;

  $image_02 = $_FILES['image_02']['name'];
  $image_02 = filter_var($image_02, FILTER_SANITIZE_STRING);
  $image_02_ext=pathinfo($image_02, PATHINFO_EXTENSION);
  $rename_image_02 = create_unique_id().'.'.$image_02_ext;
  $image_02_tmp_name = $_FILES['image_02']['tmp_name'];
  $image_02_size = $_FILES['image_02']['size'];
  $image_02_folder = 'uploaded_files/'.$rename_image_02;

  if(!empty($image_02)){
    if($image_02_size>2000000){
      $warning_msg[] = 'Image 02 size is too large!';
    }else{
      move_uploaded_file($image_02_tmp_name, $image_02_folder);
    }
  }else{
    $rename_image_02 = '';
  }

  $image_03 = $_FILES['image_03']['name'];
  $image_03 = filter_var($image_03, FILTER_SANITIZE_STRING);
  $image_03_ext=pathinfo($image_03, PATHINFO_EXTENSION);
  $rename_image_03 = create_unique_id().'.'.$image_03_ext;
  $image_03_tmp_name = $_FILES['image_03']['tmp_name'];
  $image_03_size = $_FILES['image_03']['size'];
  $image_03_folder = 'uploaded_files/'.$rename_image_03;

  if(!empty($image_03)){
    if($image_03_size>2000000){
      $warning_msg[] = 'Image 03 size is too large!';
    }else{
      move_uploaded_file($image_03_tmp_name, $image_03_folder);
    }
  }else{
    $rename_image_03 = '';
  }

  if($image_01_size>2000000){
    $warning_msg[] = 'Image 01 size is too large!';
  }else{
    $add_product = $conn->prepare("INSERT INTO `products`(id,user_id, image_01, image_02, image_03, product_name, product_price, color, size, product_brand, product_material, product_manufacturer, available, rated, installation, warranty) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
    $add_product->execute([$id, $user_id, $rename_image_01, $rename_image_02, $rename_image_03, $product_name, $product_price, $color, $size, $product_brand, $product_material, $product_manufacturer, $available, $rated, $installation, $warranty]);
    move_uploaded_file($image_01_tmp_name, $image_01_folder);
    $success_msg[] = 'Product added successfully!';
  }
}

//image_01
//image_02
//image_03
//product_name
//product_price
//color
//size
//product_brand
//product_material
//product_manufacturer
//available
//rated
//installation
//warranty

?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lighten Up - Add Product</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

<!-- Custom CSS -->
<link rel="stylesheet" type="text/css" href="css/loader.css" />
<link rel="stylesheet" type="text/css" href="css/navbar.css" />
<link rel="stylesheet" type="text/css" href="css/banner.css" />
<link rel="stylesheet" type="text/css" href="css/style.css" />

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Spectral:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Karla:wght@300;400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>
<!-- Loader -->
<div class="loading-screen">
    <div class="loader text-center">
        <span>&lt;</span>
        <span>Gemlyte IT Solutions</span>
        <span>/&gt;</span>
    </div>
</div>

<!-- Main Content -->
<div id="main-content" style="display:none">
<?php include "components/navbar.php"; ?>

<!-- add product section -->
<section class="add-product py-5 d-flex align-items-center">
  <div class="container d-flex justify-content-center">
    <div class="col-md-8">
      <div class="bg-white p-3 p-sm-4 p-md-5 rounded-4 shadow-sm form-card animate-fade-up">
        <form action="" method="POST">
          <h2 class="mb-4 text-center">Add Product</h2>

          <h4 class="mb-4 text-center">Image section</h4>
          <div class="mb-3">
            <label for="image_01" class="form-label fw-semibold">Main Image 1</label>
            <input type="file" class="form-control form-control-lg" id="image_01" name="image_01" placeholder="Main Image 1" accept="image/*" required />
          </div>
          <div class="mb-3">
            <label for="image_02" class="form-label fw-semibold">Main Image 2</label>
            <input type="file" class="form-control form-control-lg" id="image_02" name="image_02" placeholder="Main Image 2" accept="image/*" required />
          </div>
          <div class="mb-3">
            <label for="image_03" class="form-label fw-semibold">Main Image 3</label>
            <input type="file" class="form-control form-control-lg" id="image_03" name="image_03" placeholder="Main Image 3" accept="image/*" required />
          </div> 
          <h4 class="mb-4 text-center">Product Details</h4>         
          <div class="mb-3">
            <label for="product_name" class="form-label fw-semibold">Product Name</label>
            <input type="text" class="form-control form-control-lg" id="product_name" name="product_name" placeholder="Product Name" required/>
          </div>
          <div class="mb-3">
            <label for="product_price" class="form-label fw-semibold">Product Price</label>
            <input type="text" class="form-control form-control-lg" id="product_price" name="product_price" placeholder="MRP Price" required/>
          </div>
          <div class="mb-3">
            <label for="color" class="form-label fw-semibold">Select Color</label>
            <select class="form-select form-select-lg" id="color" name="color" required>
              <option value="" disabled selected>Select Color</option>
              <option value="red">Red</option>
              <option value="blue">Blue</option>
              <option value="yellow">Yellow</option>
              <option value="green">Green</option>
              <option value="black">Black</option>
              <option value="white">White</option>
              </select>
          </div>
          <div class="mb-3">
            <label for="size" class="form-label fw-semibold">Select Size</label>
            <select class="form-select form-select-lg" id="size" name="size" required>
              <option value="" disabled selected>Select Size</option>
              <option value="size_01">48</option>
              <option value="size_02">56</option>
              <option value="size_03">60</option>
            </select>
          </div>

          <h4 class="mb-4 text-center">Product Specifications</h4>
          <div class="mb-3">
            <label for="product_brand" class="form-label fw-semibold">Product Brand</label>
            <input type="text" class="form-control form-control-lg" id="product_brand" name="product_brand" placeholder="Product Brand" required/>
          </div>
          <div class="mb-3">
            <label for="product_material" class="form-label fw-semibold">Product Material</label>
            <input type="text" class="form-control form-control-lg" id="product_material" name="product_material" placeholder="Product Material" required/>
          </div>
          <div class="mb-3">
            <label for="product_manufacturer" class="form-label fw-semibold">Product Manufacturer</label>
            <input type="text" class="form-control form-control-lg" id="product_manufacturer" name="product_manufacturer" placeholder="Product Manufacturer" required/>
          </div>

          <h4 class="mb-4 text-center">Why You'll Love It</h4>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="available" name="available" required>
            <label class="form-check-label fw-semibold" for="available">
              Available both online and in-store
            </label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="rated" name="rated" required>
            <label class="form-check-label fw-semibold" for="rated">
              Highly rated by customers
            </label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="installation" name="installation" required>
            <label class="form-check-label fw-semibold" for="installation">
              Includes installation and after-sales support
            </label>
          </div>
           <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="warranty" name="warranty" required>
            <label class="form-check-label fw-semibold" for="warranty">
              Comes with a manufacturer warranty
            </label>
          </div>
          <button type="submit" class="btn btn-dark w-100 btn-lg shadow-sm" name="add_product" >Add Product now!
          </button>
        </form>
      </div>
    </div>
  </div>
</section>
<!-- add product end -->


<?php include "components/footer.php"; ?>
</div>

<!-- Loader JS -->
<script src="js/loader.js"></script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

<!-- Image Preview Script -->
<script>

<?php include 'components/message.php'; ?>
</body>
</html>